{% extends 'UI/_.html' %}
{% block title %}Centres{% endblock title %}
{% block content %}
    <div class='table-reponsive'>
        <table id='all_centres'
               class='datatables-table stripe order-column row-border'>
            <thead>
                <tr>
                    <th>Centre</th>
                    <th>Shorthand</th>
                    <th>Type</th>
                    <th>Type status</th>
                    <th>Assessment dates</th>
                    <th>City</th>
                    <th>Consortium</th>
                    <th>
                        <abbr title='CoreTrustSeal or Data Seal of Approval'>CoreTrustSeal</abbr>
                    </th>
                </tr>
            </thead>
            <tbody>
                {% for centre in all_centres %}
                    <tr>
                        <td>
                            <a href='/centre/{{ centre.id }}'>{{ centre.name }}</a>
                        </td>
                        <td>
                            {% if centre.website_url %}
                                <a href='{{ centre.website_url }}'>
                            {% endif %}
                                {{ centre.shorthand }}
                            {% if centre.website_url %}
                                </a>
                            {% endif %}
                        </td>
                        <td>
                        {% for centre_type in centre.centre_type.all %}
                            {{ centre_type }}
                            {% if not forloop.last %}
                                <br/>
                            {% endif %}
                        {% endfor %}
                        </td>
                        <td>
                        {% if centre.type_certification_status_fks %}
                            {% for type_certification_status in centre.type_certification_status_fks.all %}
                                {% if type_certification_status.certification_status.status %}
                                    <div>
                                    {{ type_certification_status.certification_status.status }}
                                    {% if type_certification_status.type_status_comment and type_certification_status.type_status_comment != type_certification_status.certification_status.status %}
                                        <br/>
                                        <small>{{ type_certification_status.type_status_comment }}</small>
                                    {% endif %}
                                    </div>
                                {% else %}
                                    <em>none</em>
                                {% endif %}
                                {% if not forloop.last %}
                                    <br/>
                                {% endif %}
                            {% endfor %}
                        {% else %}
                            <em>none</em>
                        {% endif %}
                        </td>
                        <td>
                            {% if centre.type_certification_status_fks %}
                                {% for type_certification_status in centre.type_certification_status_fks.all %}
                                    {% if type_certification_status.type_certificate_url %}
                                        <div title="certificate">
                                        <a href='{{ type_certification_status.type_certificate_url }}'>
                                    {% endif %}
                                    {{ type_certification_status.assessmentdate.brief }}
                                    {% if type_certification_status.type_certificate_url %}
                                        </a>
                                        </div>
                                    {% endif %}
                                    {% if not forloop.last %}
                                        <br/>
                                    {% endif %}
                                {% endfor %}
                            {% endif %}
                        </td>
                        <td>
                            <a href='//www.openstreetmap.org/?&amp;mlat={{ centre.latitude }}&amp;mlon={{ centre.longitude }}'>{{ centre.city }}</a>
                        </td>
                        <td>
                            {% if centre.consortium %}
                                {% if centre.consortium.website_url %}
                                    <a href='{{ centre.consortium.website_url }}'>
                                        {{ centre.consortium }}
                                    </a>
                                {% else %}
                                    {{ centre.consortium }}
                                {% endif %}
                            {% else %}
                                <em>none</em>
                            {% endif %}
                        </td>
                        <td>
                            {% if centre.dsa_url %}
                                <a href='{{ centre.dsa_url }}'>seal</a>
                            {% else %}
                                <em>none</em>
                            {% endif %}
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock content %}
